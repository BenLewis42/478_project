stroke = FALSE,
color = "Black",
popup = paste0(boba_data$name, "<br>Rating: ",
boba_data$rating, "<br>Address: ",
boba_data$address, "<br>City: ",
boba_data$city))})
# Plot 1 (Kim)
output$plot1 <- renderPlotly({
plot <- boba_df_group <- boba_dataframe %>%
group_by(city) %>%
mutate(
Number_of_Boba_Shops = n()
) %>%
mutate(
Average_Boba_Rating = mean(rating)
) %>%
summarize(
Number_of_Shops = Number_of_Boba_Shops,
Average_Boba_Rating = Average_Boba_Rating,
City = city
) %>%
distinct() %>%
arrange(-Number_of_Shops)
boba_df_group <- boba_dataframe %>%
group_by(city) %>%
mutate(
Number_of_Boba_Shops = n()
) %>%
mutate(
Average_Boba_Rating = mean(rating)
) %>%
summarize(
Number_of_Shops = Number_of_Boba_Shops,
Average_Boba_Rating = Average_Boba_Rating,
City = city
) %>%
distinct() %>%
arrange(-Number_of_Shops)
return(plot_ly(
data = boba_df_group,
x = ~Average_Boba_Rating,
y = ~Number_of_Shops,
text = ~City) %>%
layout(
xaxis = list(title = "Average Boba Rating"),
yaxis = list(title = "Number of Boba Shops")
))})
# Plot 2 (Allie)
output$plot2 <- renderPlotly({
boba_city_best <- boba_dataframe %>%
group_by(city) %>%
summarize(
Average_Boba_Rating = mean(rating)
) %>%
distinct() %>%
arrange(-Average_Boba_Rating) %>%
head(20)
boba_city_best$city <-
factor(boba_city_best$city, levels = unique(boba_city_best$city)
[order(boba_city_best$Average_Boba_Rating, decreasing = FALSE)])
return(plot_ly(
data = boba_city_best,
x = ~Average_Boba_Rating,
y = ~city) %>%
layout(
xaxis = list(title = "Average Boba Rating"),
yaxis = list(title = "City")
))})
}
# Plot 1 (Kim)
output$plot1 <- renderPlotly({
plot <- boba_df_group <- boba_dataframe %>%
group_by(city) %>%
mutate(
Number_of_Boba_Shops = n()
) %>%
mutate(
Average_Boba_Rating = mean(rating)
) %>%
summarize(
Number_of_Shops = Number_of_Boba_Shops,
Average_Boba_Rating = Average_Boba_Rating,
City = city
) %>%
distinct() %>%
arrange(-Number_of_Shops)
boba_df_group <- boba_dataframe %>%
group_by(city) %>%
mutate(
Number_of_Boba_Shops = n()
) %>%
mutate(
Average_Boba_Rating = mean(rating)
) %>%
summarize(
Number_of_Shops = Number_of_Boba_Shops,
Average_Boba_Rating = Average_Boba_Rating,
City = city
) %>%
distinct() %>%
arrange(-Number_of_Shops)
return(plot_ly(
data = boba_df_group,
x = ~Average_Boba_Rating,
y = ~Number_of_Shops,
text = ~City) %>%
layout(
xaxis = list(title = "Average Boba Rating"),
yaxis = list(title = "Number of Boba Shops")
))})
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp()
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
runApp('Desktop/code/project-aswecker')
shiny::runApp('Desktop/code/personal/FantasyFootball')
shiny::runApp('Desktop/code/personal/FantasyFootball')
# Script in which you should do your analysis described on Canvas
library("HSAUR")
library("MASS")
library("Epi")
# Tuberculosis
# https://cran.r-project.org/web/packages/HSAUR/HSAUR.pdf
# odds ratio
data("BCG")
# Low Birth Weight
# binary
# relative risk
data("birthwt")
# use kable to create table in rmd
# Endometrial Cancer
# use method = oddsratio
data("bdendo")
force(BCG)
force(birthwt)
View(bdendo)
View(BCG)
View(BCG)
BCG %>%
mutate(
BCGnoTB = BCGVacc - BCGTB
)
# Script in which you should do your analysis described on Canvas
library("HSAUR")
library("MASS")
library("Epi")
library("dplyr")
# Tuberculosis
# https://cran.r-project.org/web/packages/HSAUR/HSAUR.pdf
# odds ratio
data("BCG")
# BCGTB number of subjects suffering from TB after BCG vaccination
# BCGVacc the number of subjects with BCG vaccination.
# NoVaccTB the number of subjects suffering from TB without BCG vaccination.
# NoVacc the total number of subjects without BCG vaccination.
# Latitude geographic position of the place the study was undertaken.
# Year the year the study was undertaken.
BCG %>%
mutate(
BCGnoTB = BCGVacc - BCGTB
)
BCG %>%
mutate(
BCGnoTB = BCGVacc - BCGTB
)
BCG %>%
mutate(
BCGnoTB = BCGVacc - BCGTB,
NoVaccNoTb = NoVacc - NoVaccTB
)
BCG %>%
mutate(
BCGnoTB = BCGVacc - BCGTB,
NoVaccNoTB = NoVacc - NoVaccTB
)
BCG %>%
mutate(OR = (BCGTB * NoVaccNoTB / BCGnoTB * NoVaccTB)
)
BCG %>%
mutate(
BCGnoTB = BCGVacc - BCGTB,
NoVaccNoTB = NoVacc - NoVaccTB
)
# Odds Ratio
BCG %>%
mutate(OR = (BCGTB * NoVaccNoTB / BCGnoTB * NoVaccTB)
)
BCG %>%
mutate(
BCGnoTB = BCGVacc - BCGTB,
NoVaccNoTB = NoVacc - NoVaccTB
)
BCG %>%
mutate(
BCGnoTB = BCGVacc - BCGTB,
NoVaccNoTB = NoVacc - NoVaccTB
)
BCG %>%
mutate(OR = (BCGTB * NoVaccNoTB/ BCGnoTB * NoVaccTB)
)
BCG %>%
mutate(
OR = (BCGTB * NoVaccNoTB/ BCGnoTB * NoVaccTB)
)
BCG %>%
mutate(
OR = (BCGTB * NoVaccNoTB / BCGnoTB * NoVaccTB)
)
View(BCG)
BCG <- BCG %>%
mutate(
BCGnoTB = BCGVacc - BCGTB,
NoVaccNoTB = NoVacc - NoVaccTB
)
# Odds Ratio
BCG <- BCG %>%
mutate(
OR = (BCGTB * NoVaccNoTB / BCGnoTB * NoVaccTB)
)
BCG <- BCG %>%
mutate(
OR = (BCGTB * NoVaccNoTB) / (BCGnoTB * NoVaccTB)
)
# Script in which you should do your analysis described on Canvas
library("HSAUR")
library("MASS")
library("Epi")
library("dplyr")
# Tuberculosis
# https://cran.r-project.org/web/packages/HSAUR/HSAUR.pdf
# odds ratio
data("BCG")
# BCGTB number of subjects suffering from TB after BCG vaccination
# BCGVacc the number of subjects with BCG vaccination.
# NoVaccTB the number of subjects suffering from TB without BCG vaccination.
# NoVacc the total number of subjects without BCG vaccination.
# Latitude geographic position of the place the study was undertaken.
# Year the year the study was undertaken.
# new columns
BCG <- BCG %>%
mutate(
BCGnoTB = BCGVacc - BCGTB,
NoVaccNoTB = NoVacc - NoVaccTB
)
# Odds Ratio
BCG <- BCG %>%
mutate(
OR = (BCGTB * NoVaccNoTB) / (BCGnoTB * NoVaccTB)
)
# or = BCGTB
# Low Birth Weight
# binary
# relative risk
data("birthwt")
# use kable to create table in rmd
# Endometrial Cancer
# use method = oddsratio
data("bdendo")
library("ggplot")
library("ggplot2")
BCG_plot <- ggplot(data = BCG) +
aes(x = OR, y = year) +
geom_line()
force(birthwt)
BCG_plot <- ggplot(data = BCG, aes(x = OR, y = year)) +
geom_line() +
geom_point() +
labs(title = "OR vs year", x = "OR", y = "Year")
BCG_plot
BCG_plot
BCG_plot <- ggplot(data = BCG, aes(x = OR, y = Year)) +
geom_line() +
geom_point() +
labs(title = "OR vs year", x = "OR", y = "Year")
BCG_plot
BCG_plot <- ggplot(data = BCG, aes(x = Year, y = OR)) +
geom_line() +
geom_point() +
labs(title = "OR vs year", x = "Year", y = "OR")
BCG_plot
BCG_plot <- ggplot(data = BCG, aes(x = Year, y = OR)) +
geom_point() +
labs(title = "OR vs year", x = "Year", y = "OR")
BCG_plot
BCG_plot <- ggplot(data = BCG, aes(x = Year, y = OR)) +
geom_point() +
labs(title = "OR of TB after BCG vaccination by Year", x = "Year", y = "OR")
BCG_plot
BCG_plot_OR <- ggplot(data = BCG, aes(x = Study, y = OR)) +
geom_bar(stat="identity") +
labs(title = "OR of TB after BCG vaccination by Study", x = "Study", y = "OR")
BCG_plot_OR <- ggplot(data = BCG, aes(x = Study, y = OR)) +
geom_bar(stat="identity") +
labs(title = "OR of TB after BCG vaccination by Study", x = "Study", y = "OR")
BCG_plot_OR
BCG_plot_year <- ggplot(data = BCG, aes(x = Year, y = OR)) +
geom_bar(stat="identity") +
labs(title = "OR of TB after BCG vaccination by Year", x = "Year", y = "Odds Ratio")
BCG_plot_year
# Low Birth Wei
BCG_plot_year <- ggplot(data = BCG, aes(x = Year, y = OR)) +
geom_point() +
labs(title = "OR of TB after BCG vaccination by Year", x = "Year", y = "Odds Ratio")
BCG_plot_year
BCG_plot_lat <- ggplot(data = BCG, aes(x = Latitude, y = OR)) +
geom_point() +
labs(title = "OR of TB after BCG vaccination by Latitude", x = "Latitude", y = "Odds Ratio")
BCG_plot_lat
BCG_plot_year
BCG_plot_lat
BCG <- BCG %>%
mutate(RR = (BCGTB / BCGVAcc) / (NoVaccTB / NoVacc))
BCG <- BCG %>%
mutate(RR = (BCGTB / BCGVacc) / (NoVaccTB / NoVacc))
BCG_plot_rr_or <- ggplot(data = BCG, aes(x = RR, y = OR)) +
geom_point() +
labs(title = "OR vs RR of TB after BCG vaccination by Latitude", x = "Relative Risk", y = "Odds Ratio")
BCG_plot_rr_or
ht_odds_ratio
# Script in which you should do your analysis described on Canvas
library("HSAUR")
library("MASS")
library("Epi")
library("dplyr")
library("ggplot2")
library("tidyverse")
library("epitools")
library("rlang")
library("patchwork")
# Tuberculosis
# https://cran.r-project.org/web/packages/HSAUR/HSAUR.pdf
# odds ratio
data("BCG")
# BCGTB number of subjects suffering from TB after BCG vaccination
# BCGVacc the number of subjects with BCG vaccination.
# NoVaccTB the number of subjects suffering from TB without BCG vaccination.
# NoVacc the total number of subjects without BCG vaccination.
# Latitude geographic position of the place the study was undertaken.
# Year the year the study was undertaken.
# new columns
BCG <- BCG %>%
mutate(
BCGnoTB = BCGVacc - BCGTB,
NoVaccNoTB = NoVacc - NoVaccTB
)
# Odds Ratio
BCG <- BCG %>%
mutate(
OR = (BCGTB * NoVaccNoTB) / (BCGnoTB * NoVaccTB)
)
# visualization
BCG_plot_OR <- ggplot(data = BCG, aes(x = Study, y = OR)) +
geom_bar(stat="identity") +
labs(title = "OR of TB after BCG vaccination by Study", x = "Study", y = "Odds Ratio")
BCG_plot_OR
BCG_plot_year <- ggplot(data = BCG, aes(x = Year, y = OR)) +
geom_point() +
labs(title = "OR of TB after BCG vaccination by Year", x = "Year", y = "Odds Ratio")
BCG_plot_year
BCG_plot_lat <- ggplot(data = BCG, aes(x = Latitude, y = OR)) +
geom_point() +
labs(title = "OR of TB after BCG vaccination by Latitude", x = "Latitude", y = "Odds Ratio")
BCG_plot_lat
# analysis: Except for some exceptions, it seems like the BCG vaccine is quite
# effective in reducing the odds of TB. While there are some higher ORs in some of the studies,
# looking at it by year, it can be seen that the OR increases over time, suggesting a decrease in the effectivenss
# of the vaccine over the years. This may be attributed to a decrease in vaccine efficacy over time
# with lower antibody levels. Higher latitudes also seem to have lower ORs, possibly suggesting where
# you are matters on how effective the vaccine is in protecting you. For example, a place with higher
# incidence of TB will have a harder time protecting you from it compared to a place with low incidence.
BCG <- BCG %>%
mutate(RR = (BCGTB / BCGVacc) / (NoVaccTB / NoVacc))
BCG_plot_rr_or <- ggplot(data = BCG, aes(x = RR, y = OR)) +
geom_point() +
labs(title = "OR vs RR of TB after BCG vaccination by Latitude", x = "Relative Risk", y = "Odds Ratio")
BCG_plot_rr_or
BCG_plots1 <- BCG_plot_OR + BCG_plot_rr_or
BCG_plots2 <- BCG_plot_year + BCG_plot_lat
# The relative risk and the odds ratio seem to be very similar when compared to each other.
# Low Birth Weight
# binary
# relative risk
data("birthwt")
prop_smoker <- sum(birthwt$smoke == 1) / nrow(birthwt)
prop_lbwt <- sum(birthwt$low == 1) / nrow(birthwt)
prop_ht <- sum(birthwt$ht == 1) / nrow(birthwt)
mean_bwt <- mean(birthwt$bwt)
binary_rr <- function(df, column) {
col_pos = sum(df[, column] == 1)
col_neg = sum(df[, column] == 0)
col_pos_low_weight = sum(df$low == 1 & df[, column] == 1)
col_neg_low_weight = sum(df$low == 1 & df[, column] == 0)
exp = col_pos_low_weight / col_pos
no_exp = col_neg_low_weight / col_neg
RR = exp / no_exp
return(RR)
}
smoke_rr <- binary_rr(birthwt, "smoke")
ht_rr <- binary_rr(birthwt, "ht")
birthwt <- birthwt %>%
mutate(
zero_visits = ifelse(birthwt$ftv<1,"1","0")
)
zero_visits_rr <- binary_rr(birthwt, "zero_visits")
birthwt <- birthwt %>%
mutate(
age_twenty = ifelse(birthwt$age < 20,"1","0")
)
twenty_rr <- binary_rr(birthwt, "age_twenty")
df <- data.frame(smoke_rr, ht_rr, zero_visits_rr, twenty_rr)
df <- df %>%
rename(
"Smoking"= smoke_rr,
"Hypertension"= ht_rr,
"Zero Prenatal Visits" = zero_visits_rr,
"Before Age of 20" = twenty_rr
)
# The analysis suggests that mothers who are smokers, have zero prenatal visits,
# and have history of hypertension have higher risk of having a baby with low birth weight
# Meanwhile, mothers who are under the age of twenty have slightly lower risk of having a baby
# with a low birth weight. Those with hypertension seems to have the highest risk of having a low
# birth weight child.
# use kable to create table in rmd
# Endometrial Cancer
# use method = oddsratio
# use matrix
data("bdendo")
matrix_create <- function(df, col) {
disease_pos_ct <- df %>%
filter(d == 1, !!as.name(col) == "Yes") %>%
nrow()
print(disease_pos_ct)
non_disease_pos_ct <- df %>%
filter(d == 0, !!as.name(col) == "Yes") %>%
nrow()
disease_neg_ct <- df %>%
filter(d == 1, !!as.name(col) == "No") %>%
nrow()
non_disease_neg_ct <- df %>%
filter(d == 0, !!as.name(col) == "No") %>%
nrow()
input <- matrix(c(disease_pos_ct, non_disease_pos_ct, disease_neg_ct, non_disease_neg_ct), 2, 2)
return(input)
}
ht_matrix <- matrix_create(bdendo, "hyp")
gall_matrix <- matrix_create(bdendo, "gall")
ob_matrix <- matrix_create(bdendo, "ob")
ht_odds_ratio <- epitab(ht_matrix, method="oddsratio")
gall_odds_ratio <- epitab(gall_matrix, method="oddsratio")
ob_odds_ratio <- epitab(ob_matrix, method="oddsratio")
ht_odds_ratio
ht_odds_ratio[1]
ht_odds_ratio[1]
ht_odds_ratio[2]
ht_odds_ratio[1]
ob_odds_ratioi[1]
ht_odds_ratio[1]
gall_odds_ratio[1]
ob_odds_ratio[1]
---
title: "index"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r}
setwd('~/GitHub/478_project')
data <- read.csv('data/us_state_vaccinations.csv')
```
---
title: "index"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r}
data <- read.csv('data/us_state_vaccinations.csv')
```
